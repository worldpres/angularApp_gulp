var app=angular.module("application",["ngRoute"]);app.config(function($routeProvider){$routeProvider.when("/",{templateUrl:"start.html",controller:"ctrlStart"}).when("/logowanie",{templateUrl:"log.html",controller:"ctrlLog"}).when("/wylogowanie",{template:"<div class='col-sm-12 text-center alert alert-success'><strong>Wylogowano!</strong> Zostaniesz przekierowany za {{timeOff}}s.</div>",controller:"ctrlOff"}).when("/rejestracja",{templateUrl:"reg.html",controller:"ctrlReg"}).when("/edycja",{templateUrl:"edit.html",controller:"ctrlEdit"}).when("/lista",{templateUrl:"lista.html",controller:"ctrlList"}).when("/powitanie",{templateUrl:"tekst.html",controller:"ctrlText"}).otherwise({template:"<div class='col-sm-12 text-center alert alert-warning'><strong>404!</strong> Nie ma takiej strony. Zostaniesz przekierowany za {{timeOff}}s.</div>",controller:"notFound"})}),app.controller("ctrlMenu",["$window","$scope","$location",function($window,$scope,$location){$window.localStorage.userId?($scope.userId=$window.localStorage.userId,$scope.userLogin=$window.localStorage.userLogin):$scope.userId=!1,"admin"!=$window.localStorage.userLogin&&$('a[href="#lista"], a[href="#powitanie"]').parent().hide()}]),app.controller("ctrlStart",["$http","$scope","$sce",function(o,$scope,$sce){o.get("http://kambudpa.linuxpl.info/api.php/ng_text/id/1/").success(function(o){o=o[0],$scope.startText=$sce.trustAsHtml(o.text)})}]),app.controller("ctrlLog",["$http","$window","$scope","$location",function(o,$window,$scope,$location){$window.localStorage.userLogin&&$location.path("/"),$scope.zaloguj=function(){o.get("http://kambudpa.linuxpl.info/api.php/ng_users/login/"+$scope.login+"/password/"+$scope.password).success(function(o){o=o[0],void 0!==o&&null!==o?($window.localStorage.userLogin=o.login,$window.localStorage.userId=o.id,$location.path("/")):$scope.loginIncorrect=!0})}}]),app.controller("ctrlOff",["$window","$interval","$scope","$location",function($window,$interval,$scope,$location){$window.localStorage.userId="",$window.localStorage.userLogin="",$scope.timeOff=3,$interval(function(){$scope.timeOff--,0==$scope.timeOff&&$location.path("/")},1e3)}]),app.controller("ctrlReg",["$http","$window","$scope","$location",function(o,$window,$scope,$location){$window.localStorage.userLogin&&$location.path("/"),$scope.regexLogin=/^[a-zA-Z0-9]{5,}$/,$scope.rejestruj=function(){var t={login:$scope.login,password:$scope.password,email:$scope.email};o.post("http://kambudpa.linuxpl.info/api.php/ng_users",t).success(function(o){o?($scope.rejestrujInfo="Zarejestrowano.",$scope.rejestrujInfoColor="success"):($scope.rejestrujInfo="Nie można zarejestrować tej nazwy użytkownika. Prawdopodobnie już istnieje.",$scope.rejestrujInfoColor="warning")})}}]),app.controller("ctrlEdit",["$timeout","$http","$window","$scope",function($timeout,o,$window,$scope){$scope.regexLogin=/^[a-zA-Z0-9]{5,}$/,$scope.regexWww=/^(http|https):\/\/[a-zA-Z0-9-.]+[\.]{1}[a-zA-Z]{2,4}$/,$scope.userId=$window.localStorage.userId,o.get("http://kambudpa.linuxpl.info/api.php/ng_users/id/"+$scope.userId).success(function(o){$scope.user=o[0],$scope.user.birth=new Date($scope.user.birth)}),$scope.zapiszZmiany=function(){var t=[$scope.user];o.put("http://kambudpa.linuxpl.info/api.php/ng_users",t).success(function(o){o?$scope.zapiszZmianyInfoColor="success":$scope.zapiszZmianyInfoColor="warning"}),$timeout(function(){$scope.zapiszZmianyInfoColor="default"},3e3)},$scope.zapiszZmianyInfoColor="default"}]),app.controller("ctrlText",["$timeout","$http","$window","$scope","$location",function($timeout,o,$window,$scope,$location){"admin"!=$window.localStorage.userLogin&&$location.path("/"),o.get("http://kambudpa.linuxpl.info/api.php/ng_text/id/1").success(function(o){$scope.start=o[0],$("#editor").html(o[0].text)}),$scope.zapiszTekst=function(){$scope.start.id=1,$scope.start.text=$("#editor").html();var t=[$scope.start];o.put("http://kambudpa.linuxpl.info/api.php/ng_text",t).success(function(o){o?$scope.zapiszTekstInfoColor="success":$scope.zapiszTekstInfoColor="warning"}),$timeout(function(){$scope.zapiszTekstInfoColor="default"},3e3)},$scope.zapiszTekstInfoColor="default",$("#editor").wysiwyg()}]),app.controller("notFound",["$interval","$scope","$location",function($interval,$scope,$location){$scope.timeOff=3,$interval(function(){$scope.timeOff--,0==$scope.timeOff&&$location.path("/")},1e3)}]),app.controller("ctrlList",["$timeout","$http","$window","$scope","$location",function($timeout,t,$window,$scope,$location){"admin"!=$window.localStorage.userLogin&&$location.path("/"),t.get("http://kambudpa.linuxpl.info/api.php/ng_users").success(function(t){$scope.listaKont=t;for(o in $scope.listaKont)$scope.listaKont[o].birth=new Date($scope.listaKont[o].birth)}),$scope.headerObj={login:"Login",email:"Email",phone:"Telefon",nation:"Kraj",birth:"Data urodzenia",www:"WWW"},$scope.sortDir=!1,$scope.sortVal="login",$scope.setSort=function(o){$scope.sortVal===o&&($scope.sortDir=!$scope.sortDir),$scope.sortVal=o},$scope.download=function(){t.get("http://kambudpa.linuxpl.info/api.php/ng_users").success(function(t){t?$scope.downloadColor="success":$scope.downloadColor="warning",$scope.listaKont=t;for(o in $scope.listaKont)$scope.listaKont[o].birth=new Date($scope.listaKont[o].birth)}),$timeout(function(){$scope.downloadColor="default"},3e3)},$scope.downloadColor="default",$scope.upload=function(){$scope.downloadColor="default";var o=$scope.listaKont;t.put("http://kambudpa.linuxpl.info/api.php/ng_users",o).success(function(o){o?$scope.uploadColor="success":$scope.uploadColor="warning"}),$timeout(function(){$scope.uploadColor="default"},3e3)},$scope.uploadColor="default",$scope.del=function(o){var e=confirm("Usunąc usera o id: "+o+" ?");e&&t.delete("http://kambudpa.linuxpl.info/api.php/ng_users/id/"+o+"/").success(function(o){$scope.download()})}}]);